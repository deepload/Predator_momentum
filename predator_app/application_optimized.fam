App(
    appid="predator_optimized",
    name="Predator Security Suite",
    apptype=FlipperAppType.EXTERNAL,
    entry_point="predator_app",
    requires=["gui", "dialogs", "storage", "notification", "subghz", "nfc", "bt", "gpio", "power"],
    stack_size=8 * 1024,  # REDUCED from 10KB
    fap_category="Tools",
    fap_description="Professional Security Toolkit - Memory Optimized",
    fap_version="2.0",
    fap_author="Nico Lococo - Elon's Startup",
    fap_weburl="https://github.com/predator-momentum/flipper",
    targets=["f7"],
    cdefines=["HEAP_SIZE=16000", "MEMORY_OPTIMIZED=1", "COMPACT_STRINGS=1"],  # REDUCED heap
    sources=[
        # Core application
        "predator.c",
        "predator_uart.c",

        # ESSENTIAL helpers only - MEMORY OPTIMIZED
        "helpers/predator_boards.c",
        "helpers/predator_error.c",
        "helpers/predator_esp32.c",
        "helpers/predator_gps.c",
        "helpers/predator_compliance.c",
        "helpers/predator_models_hardcoded.c",  # Keep 90+ models
        "helpers/predator_subghz.c",
        "helpers/predator_settings.c",
        "helpers/predator_logging.c",
        "helpers/predator_real_attack_engine.c",
        "helpers/predator_memory_optimized.c",  # REPLACES: ui_elements, watchdog, string, ui_callbacks, scene_utils
        
        # Scene router
        "scenes/predator_scene.c",

        # MEMORY OPTIMIZED - CORE SCENES ONLY
        "scenes/predator_scene_main_menu_ui.c",
        
        # Tesla & Car Security (CORE BUSINESS) - KEEP ALL
        "scenes/predator_scene_car_tesla_ui.c",
        "scenes/predator_scene_universal_car_hacker.c",  # ALL-IN-ONE SOLUTION
        "scenes/predator_scene_car_attacks_ui.c",        # Navigation hub
        "scenes/predator_scene_car_key_bruteforce_ui.c",
        "scenes/predator_scene_car_jamming_ui.c",
        "scenes/predator_scene_car_passive_opener_ui.c",
        "scenes/predator_scene_walking_open_ui.c",
        
        # WiFi Attacks (GOVERNMENT GRADE) - ESSENTIAL ONLY
        "scenes/predator_scene_wifi_attacks_ui.c",
        "scenes/predator_scene_wifi_scan_ui.c",
        "scenes/predator_scene_wifi_deauth_ui.c",
        "scenes/predator_scene_wifi_evil_twin_ui.c",
        # REMOVED: wifi_handshake_ui.c, wifi_pmkid_ui.c (can be added later)
        
        # Bluetooth Attacks (ESSENTIAL)
        "scenes/predator_scene_bluetooth_attacks_ui.c",
        "scenes/predator_scene_ble_scan_ui.c",
        "scenes/predator_scene_ble_spam_ui.c",
        
        # RFID Attacks (ESSENTIAL)
        "scenes/predator_scene_rfid_attacks_ui.c",
        "scenes/predator_scene_rfid_clone_ui.c",
        "scenes/predator_scene_rfid_bruteforce_ui.c",
        # REMOVED: rfid_fuzzing_ui.c (can be added later)
        
        # SubGHz Attacks (ESSENTIAL)
        "scenes/predator_scene_subghz_attacks_ui.c",
        "scenes/predator_scene_subghz_jamming_ui.c",
        # REMOVED: subghz_raw_send_ui.c
        
        # GPS & Navigation (ESSENTIAL)
        "scenes/predator_scene_gps_tracker_ui.c",
        "scenes/predator_scene_wardriving_ui.c",
        
        # Social Engineering (ESSENTIAL)
        "scenes/predator_scene_social_engineering_ui.c",
        
        # System & Utility (MINIMAL)
        "scenes/predator_scene_module_status_ui.c",
        "scenes/predator_scene_board_selection_ui.c",
        "scenes/predator_scene_settings_ui.c",
        "scenes/predator_scene_about_ui.c",
        # REMOVED: live_monitor_ui.c (functionality integrated elsewhere)
    ],
)
